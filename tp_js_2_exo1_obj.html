<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Accueil</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
  
  
  <header>
    <h1>Sith Ouèbe de Esteban Cormier</h1>
  </header>
  
  <nav>
    <ul>
      <li><a class="menubar"  href="./index.html">Accueil</a></li>
      <li><a  class="menubar"  href="./Oldindex.html">HTML</a></li>
      <li><a  class="menubar" href="./tp_js_2_exo1.html">JS</a></li>
      <li><a  class="menubar" href="./index.html">PHP</a></li>
      <li><a  class="menubar" href="./CV.html">Qui suis-je ?</a></li>
    </ul>
    
  </nav>
</head>
<body>
  
  <button onclick="lancerCompteur()">Lancer le décompte</button>
  <div id = "decompte"></div>
  <div id="image"></div>
  
  <button onclick="lancerDeplacement()">Lancer le déplacement</button>
  <div id "deplacement"></div>
  
  
  
  <script>
  var compteur=2;
  var intervalId = null;
  function lancerCompteur(){
    intervalId = setInterval(tic, 1000);
  }
  
  function tic() {
    compteur--;
    if(compteur==0) fin();
    else {
      document.getElementById("decompte").innerHTML=compteur+" secondes restantes";
    }
  }
  
  function fin() {
    clearInterval(intervalId);
    compteur=10;
    document.getElementById("decompte").innerHTML="Joli Drop";
    document.getElementById("image").innerHTML='<img src="./media/hh.png"/>';
  }
  
  </script>
  <canvas id="canvas" width="600" height="600"></canvas>
  <div style="display:none;" >
    <img id="mirror" src="./media/mirror.png" width="50" height="50" />
  </div>
  <div style="display:none;" >
    <img id="exalt" src="./media/exalt.png" width="50" height="50" />
  </div>
  <div style="display:none;" >
    <img id="chaos" src="./media/chaos.png" width="50" height="50" />
  </div>
  <script>
  var compteurM=0;
  var compteurC=0;
  var compteurE=0;
  var compteurT=0;
  var compteury=0;
  var intervalIdD = null;
  
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");
  var imageC = document.getElementById("chaos");
  var imageM = document.getElementById("mirror");
  var imageE = document.getElementById("exalt");
  
  class Image  {
    constructor(context,image,x,y,a,b,retard){
      this.context=context;
      this.image=image;
      this.retard=retard;
      this.x=x;
      this.y=y;
      this.a=a;
      this.b=b;
    }
    
    update() {
      compteurM=compteurM+10;
      if(compteurM<=500){
        compteurT++;
        ctx.clearRect(compteurM-10, compteury, 50+2, 50+2);
        ctx.drawImage(imageM, compteurM,compteury,50,50);
      }
      if(compteurT>=10){
        compteurE=compteurE+10;
        if(compteurE<=500){
          ctx.clearRect(compteurE-10, compteury+50, 50+2, 50+2);
          ctx.drawImage(imageE, compteurE,compteury+50,50,50);
        }
      }
      if(compteurT>=30){
        compteurC=compteurC+10;
        ctx.clearRect(compteurC-10, compteury+100, 50+2, 50+2);
        ctx.drawImage(imageC, compteurC,compteury+100,50,50);
        if(compteurC>=500) finD();
      }
      
      x+=10;
      
    }
    draw(){
      context.drawImage(image, x,y,a,b);
    }
    clear(){
      context.clearRect(x-1,y,a+2,b+2);
    }
  }
  
  const imageC = new Image(ctx,imageC, 0,100,50,50,);
  const imageM = new Image(ctx,imageM, 0,0,50,50,);
  const imageE = new Image(ctx,imageE, 0,50,50,50,);
  
  const tableauImage = new Array();
  
  tableauImage.push(ImageC);
  tableauImage.push(imageM);
  tableauImage.push(imageE);
  
  
  
  function drawI(){
    tableauImage.forEach(element.draw())
  }
  
  function clearI(){
    tableauImage.forEach(element.clear());
  }
  function updateI(){
    tableauImage.forEach(element.update());
  }
  
  function end() {
    fini=true;
    tableauImage.forEach();
    if(fini){
      clearInterval(intervalIdD);
    }
  }
  
  function main(){
    clearI();
    updateI();
    drawI();
    end();
  }
  
  var intervalIdD = setInterval(main, 100);
  
</script>

</body>


</html>
